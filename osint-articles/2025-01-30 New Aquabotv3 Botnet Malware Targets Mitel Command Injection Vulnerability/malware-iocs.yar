import "hash"

rule Malicious_Malware_IOCs
{
    meta:
        description = "Detects suspicious samples referencing known malicious infrastructure and strings"

    strings:
        // --- IP addresses (as ASCII) ---
        $ip1  = "89.190.156.145"
        $ip2  = "91.92.243.233"
        $ip3  = "213.130.144.69"
        $ip4  = "154.216.16.109"
        $ip5  = "193.200.78.33"
        $ip6  = "173.239.233.47"
        $ip7  = "141.98.11.67"
        $ip8  = "141.98.11.175"
        $ip9  = "173.239.233.48"
        $ip10 = "173.239.233.46"

        // --- Domain names (as ASCII) ---
        $dom1 = "dogmuncher.xyz"
        $dom2 = "cardiacpure.ru"
        $dom3 = "fuerer-net.ru"
        $dom4 = "eye-network.ru"
        $dom5 = "intenseapi.com"
        $dom6 = "cloudboats.vip"
        $dom7 = "theeyefirewall.su"
        $dom8 = "awaken-network.net"

        // --- Unique strings from malware analysis ---
        $str_locker_killed  = "[locker] killed process: %s"
        $str_killer_node    = "[killer/node] killed process: %s"
        $str_killer_cpu     = "[killer/cpu] killed process: %s"
        $str_killer_cmd     = "[killer/cmd] killed process: %s"
        $str_killer_stat    = "[killer/stat] killed process: %s"
        $str_killer_exe     = "[killer/exe] killed process: %s"
        $str_killer_maps    = "[killer/maps] killed process: %s"

    condition:
        any of ($ip*) or       // Match if any malicious IP is found in ASCII form
        any of ($dom*) or      // Match if any malicious domain is found in ASCII form
        any of ($str_killer*) or ($str_locker_killed)
}


rule Known_Malicious_Files_by_SHA256
{
    meta:
        description = "Detects files matching known malicious SHA-256 hashes"
        hash_list = "6 known malicious samples"

    condition:
        hash.sha256(0, filesize) in (
            "597b84ba23e16b24ec17288981bbf65c84b6ba3bb07df6620378a1907692fb86",
            "6a070dc9614dbb9a76092258fdc8bd758f69126c73787dc7d2af9aebd436e7ec",
            "b41e29e745b69f3e8c11d105e7e050fd9e08ff1e22efd97fd4c239a9095d708b",
            "b5d1cf8b222162567f46281e792145774689c205701a02f3723cf6fb13a429de",
            "1e74bcd24e30947bd14cef6731ca63f69df060ba3dcac88b2321171335a6e8ef",
            "e06c3f5c32aaa422e66056290eb566065afe2ce611fe019f3ba804af939ac1a3"
        )
}