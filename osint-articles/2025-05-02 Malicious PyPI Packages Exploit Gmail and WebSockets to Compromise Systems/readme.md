# Malicious PyPI Packages Exploit Gmail and WebSockets to Compromise Systems

Seven malicious PyPI packages, downloaded over 55,000 times, were found abusing Gmail's SMTP servers and WebSockets to steal data and execute remote commands. These packages, active for years, evaded detection by leveraging trusted services, posing significant supply chain risks.

Key takeaways:

🕵️‍♂️ Malicious Packages Uncovered: Seven PyPI packages, including "Coffin-Codes-Pro" and "Coffin2022," contained backdoors for data exfiltration and remote command execution, with one package downloaded over 18,000 times.

📧 Gmail Abuse: The packages used Gmail's SMTP servers to send stolen data, bypassing firewalls and endpoint detection due to the service's trusted status.

🌐 WebSocket Exploitation: After initial exfiltration, the malware established encrypted WebSocket connections to attacker-controlled servers for persistent system control.

🔍 Long-Term Evasion: Some packages remained on PyPI for over four years, exploiting the platform's trust and highlighting vulnerabilities in open-source supply chains.

🛡️ Mitigation Urged: Developers are advised to audit dependencies, use automated scanning tools, and verify package legitimacy to prevent similar supply chain attacks.

🔗 https://buff.ly/zBHTB3Y

## Package Content

- `iocs.txt`: List of all Indicators of Compromise (IOCs) in the article.
- `malicious-packages.txt`: List of malicious python packages in the article.
- `mitre-ttps.txt`: MITRE ATT&CK tactics, techniques, and procedures in the article.
- `threat-actor-aliases.txt`: List of threat actor aliases associated with the threat.
- `threat-actor-emails.txt`: List of threat actor emails associated with the threat.

<br>

> [!NOTE]
> Use the following scripts in [threat-hunting-scripts](../../threat-hunting-scripts/) to help you hunt:
>
> - `verify-iocs-vt.py`: Verify IOCs using VirusTotal Community API.
> - `iocs-to-cs.py`: Upload IOCs to CrowdStrike Falcon IOC Management for detection and blocking.
