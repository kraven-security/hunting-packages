# CISA Warns of Chinese "BrickStorm" Malware Targeting VMware Servers

The Cybersecurity and Infrastructure Security Agency (CISA), alongside the NSA and Canadian partners, has issued a joint advisory warning of a sophisticated Chinese state-sponsored campaign using the "BrickStorm" backdoor to compromise VMware vCenter servers and Windows environments. This stealthy malware is designed for deep persistence and espionage, often evading detection for over a year while stealing sensitive credentials and data.

Key takeaways:

ğŸ¯ Strategic Targeting: Attackers are compromising critical infrastructure, government, and tech sectors, specifically targeting VMware vSphere and Windows systems to establish long-term access.

ğŸ¦  Advanced Evasion: BrickStorm uses sophisticated techniques to hide, including masquerading as legitimate VMware binaries (e.g., vmware-sphere) and communicating via DNS-over-HTTPS (DoH) and WebSockets to blend in with normal traffic.

ğŸ”„ Persistent Foothold: The malware ensures longevity by modifying VMware boot initialization scripts and employing "self-watching" processes that automatically reinstall or restart the malware if it is terminated.

ğŸ”“ Credential Theft: Once inside, the malware facilitates the theft of VM snapshots to extract credentials (such as cryptographic keys and NTDS.dit) and creates hidden rogue virtual machines to maintain access.

ğŸ›¡ï¸ Urgent Mitigation: Defenders are urged to scan for BrickStorm using CISA-provided YARA/Sigma rules, harden VMware configurations, block unauthorized DoH traffic, and enforce strict network segmentation.

ğŸ”— [Source](https://www.cisa.gov/news-events/analysis-reports/ar25-338a)

## Package Content

- `iocs.txt`: List of all Indicators of Compromise (IOCs) in the article. All endpoint IOCs.
- `yara-rules.yar`: List of YARA rules to detect the threat.
- `sigma-rules-yml`: List of Sigma rules to detect the threat.

<br>

> [!NOTE]
> Use the following scripts in [threat-hunting-scripts](../../threat-hunting-scripts/) to help you hunt:
>
> - `verify-iocs-vt.py`: Verify IOCs using VirusTotal Community API.
> - `iocs-to-cs.py`: Upload IOCs to CrowdStrike Falcon IOC Management for detection and blocking.
